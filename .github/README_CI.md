# CI/CD Pipeline Documentation

## üöÄ –û–≥–ª—è–¥

–¶–µ–π –ø—Ä–æ–µ–∫—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î GitHub Actions –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è, –∑–±—ñ—Ä–∫–∏ —Ç–∞ –¥–µ–ø–ª–æ–π–º–µ–Ω—Ç—É.

## üìã Workflows

### 1. **CI Pipeline** (`.github/workflows/ci.yml`)

–ó–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è –ø—Ä–∏:
- Push –¥–æ `main` –∞–±–æ `develop` –≥—ñ–ª–æ–∫
- Pull Request –¥–æ `main` –∞–±–æ `develop` –≥—ñ–ª–æ–∫

**–ï—Ç–∞–ø–∏:**

#### üîç **Lint & Format Check**
- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –∫–æ–¥—É (`gofmt`)
- –°—Ç–∞—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –∫–æ–¥—É (`golangci-lint`) 
- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ `go vet`
- –ö–µ—à—É–≤–∞–Ω–Ω—è Go –º–æ–¥—É–ª—ñ–≤

#### üß™ **Tests**
- –ó–∞–ø—É—Å–∫ PostgreSQL —Ç–∞ Redis —Å–µ—Ä–≤—ñ—Å—ñ–≤
- –í–∏–∫–æ–Ω–∞–Ω–Ω—è –º—ñ–≥—Ä–∞—Ü—ñ–π –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
- –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç—ñ–≤ –∑ coverage –∑–≤—ñ—Ç–æ–º
- –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è HTML –∑–≤—ñ—Ç—É –ø–æ–∫—Ä–∏—Ç—Ç—è

#### üî® **Build**
- –ó–±—ñ—Ä–∫–∞ –¥–ª—è Linux —Ç–∞ Windows
- –û–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω—ñ –±—ñ–Ω–∞—Ä–Ω—ñ —Ñ–∞–π–ª–∏ –∑ `ldflags`
- –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ñ–≤

#### üê≥ **Docker**
- –ó–±—ñ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑—É
- –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –æ–±—Ä–∞–∑—É
- –ö–µ—à—É–≤–∞–Ω–Ω—è –¥–ª—è –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è

#### üîí **Security Scan**
- –°–∫–∞–Ω—É–≤–∞–Ω–Ω—è –Ω–∞ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ (`gosec`)
- SARIF –∑–≤—ñ—Ç–∏ –¥–ª—è GitHub Security

### 2. **Release Pipeline** (`.github/workflows/release.yml`)

–ó–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ç–µ–≥—É (`v*`)

**–ú–æ–∂–ª–∏–≤–æ—Å—Ç—ñ:**
- –ó–±—ñ—Ä–∫–∞ –¥–ª—è –º–Ω–æ–∂–∏–Ω–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º (Linux, Windows, macOS)
- ARM64 —Ç–∞ AMD64 –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏
- –ü—É–±–ª—ñ–∫–∞—Ü—ñ—è Docker –æ–±—Ä–∞–∑—ñ–≤ –≤ GitHub Container Registry
- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è GitHub Release –∑ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π changelog

### 3. **Dependabot** (`.github/dependabot.yml`)

–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:
- Go –º–æ–¥—É–ª—ñ–≤ (—â–æ—Ç–∏–∂–Ω—è)
- GitHub Actions (—â–æ—Ç–∏–∂–Ω—è)
- Docker –±–∞–∑–æ–≤–∏—Ö –æ–±—Ä–∞–∑—ñ–≤ (—â–æ—Ç–∏–∂–Ω—è)

## üõ†Ô∏è –õ–æ–∫–∞–ª—å–Ω—ñ –∫–æ–º–∞–Ω–¥–∏

```bash
# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ CI
make ci-setup

# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –ª—ñ–Ω—Ç–µ—Ä
make lint

# –í–∏–ø—Ä–∞–≤–∏—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ
make lint-fix

# –§–æ—Ä–º–∞—Ç—É–≤–∞—Ç–∏ –∫–æ–¥
make format

# –¢–µ—Å—Ç–∏ –∑ –ø–æ–∫—Ä–∏—Ç—Ç—è–º
make test-cover

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–µ—Ä–µ–¥ commit
make check
```

## üìä –ü–æ–∫—Ä–∏—Ç—Ç—è –∫–æ–¥—É

- –ì–µ–Ω–µ—Ä—É—î—Ç—å—Å—è HTML –∑–≤—ñ—Ç: `coverage.html`
- –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è —è–∫ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç –≤ GitHub Actions
- –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–µ –ø–æ–∫—Ä–∏—Ç—Ç—è: —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è 80%+

## üè∑Ô∏è –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ä–µ–ª—ñ–∑—É

1. –°—Ç–≤–æ—Ä—ñ—Ç—å —Ç–µ–≥:
   ```bash
   git tag v1.0.0
   git push origin v1.0.0
   ```

2. GitHub –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ:
   - –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç–∏
   - –ó—ñ–±–µ—Ä–µ –±—ñ–Ω–∞—Ä–Ω—ñ —Ñ–∞–π–ª–∏
   - –°—Ç–≤–æ—Ä–∏—Ç—å Docker –æ–±—Ä–∞–∑
   - –û–ø—É–±–ª—ñ–∫—É—î —Ä–µ–ª—ñ–Ω

## üê≥ Docker –æ–±—Ä–∞–∑–∏

–û–±—Ä–∞–∑–∏ –ø—É–±–ª—ñ–∫—É—é—Ç—å—Å—è –≤ `ghcr.io/[username]/pets_search_rest`:
- `latest` - –æ—Å—Ç–∞–Ω–Ω—ñ–π —Ä–µ–ª—ñ–Ω
- `v1.0.0` - –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞ –≤–µ—Ä—Å—ñ—è

## üîí Security Features

- **Gosec** - —Å—Ç–∞—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –±–µ–∑–ø–µ–∫–∏
- **SARIF upload** - —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ GitHub Security
- **Dependabot** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π
- **Docker scan** - —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –æ–±—Ä–∞–∑—ñ–≤

## ‚ö° –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó

- **Go modules cache** - –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è –∑–±—ñ—Ä–∫–∏
- **Docker buildx cache** - —à–≤–∏–¥—à—ñ Docker –∑–±—ñ—Ä–∫–∏
- **Parallel jobs** - –ø–∞—Ä–∞–ª–µ–ª—å–Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –µ—Ç–∞–ø—ñ–≤
- **–û–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω—ñ –±—ñ–Ω–∞—Ä–Ω—ñ —Ñ–∞–π–ª–∏** - –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä

## üéØ Best Practices

1. **–ó–∞–≤–∂–¥–∏ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ —Ç–µ—Å—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–æ** –ø–µ—Ä–µ–¥ push
2. **–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `make check`** –ø–µ—Ä–µ–¥ commit
3. **–ü–∏—à—ñ—Ç—å —Ç–µ—Å—Ç–∏** –¥–ª—è –Ω–æ–≤–æ–≥–æ –∫–æ–¥—É
4. **–î–æ—Ç—Ä–∏–º—É–π—Ç–µ—Å—å** —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –∫–æ–¥—É
5. **–û–Ω–æ–≤–ª—é–π—Ç–µ** –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ —Ä–µ–≥—É–ª—è—Ä–Ω–æ

## üö® Troubleshooting

### –ü–æ–º–∏–ª–∫–∏ –ª—ñ–Ω—Ç–∏–Ω–≥—É
```bash
# –í–∏–ø—Ä–∞–≤–∏—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ
make lint-fix

# –†—É—á–Ω–µ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è
make format
```

### –¢–µ—Å—Ç–∏ –Ω–µ –ø—Ä–æ—Ö–æ–¥—è—Ç—å
```bash
# –õ–æ–∫–∞–ª—å–Ω–∏–π –∑–∞–ø—É—Å–∫ –∑ –¥–µ—Ç–∞–ª—è–º–∏
go test -v ./...

# –ó race detection
go test -race ./...
```

### Docker –∑–±—ñ—Ä–∫–∞ –ø–∞–¥–∞—î
```bash
# –õ–æ–∫–∞–ª—å–Ω–∞ –∑–±—ñ—Ä–∫–∞
docker build -t pets-api .

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –æ–±—Ä–∞–∑—É
docker run --rm pets-api --help
```

## üìà –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥

GitHub –Ω–∞–¥–∞—î –º–µ—Ç—Ä–∏–∫–∏:
- –ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è workflows
- –£—Å–ø—ñ—à–Ω—ñ—Å—Ç—å –∑–±—ñ—Ä–æ–∫
- –ü–æ–∫—Ä–∏—Ç—Ç—è –∫–æ–¥—É
- Security alerts
